<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MediBot ‚Äî AI Medical Assistant</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0a0e14;
    --surface: #111720;
    --surface2: #161e2a;
    --border: #1e2d40;
    --accent: #00c9a7;
    --accent2: #0094d4;
    --accent-glow: rgba(0,201,167,0.15);
    --text: #e8f0fe;
    --text-muted: #6b8299;
    --text-dim: #3d5166;
    --user-bubble: #0e2a3f;
    --bot-bubble: #0f1e2b;
    --red: #ff4d6d;
    --yellow: #ffd166;
  }

  html, body {
    height: 100%;
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    overflow: hidden;
  }

  /* Background grid */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,201,167,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,201,167,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  body::after {
    content: '';
    position: fixed;
    top: -200px;
    right: -200px;
    width: 600px;
    height: 600px;
    background: radial-gradient(circle, rgba(0,148,212,0.07) 0%, transparent 70%);
    pointer-events: none;
    z-index: 0;
  }

  .layout {
    display: flex;
    height: 100vh;
    position: relative;
    z-index: 1;
  }

  /* ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ */
  .sidebar {
    width: 280px;
    flex-shrink: 0;
    background: var(--surface);
    border-right: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    padding: 0;
    animation: slideInLeft 0.5s ease;
  }

  @keyframes slideInLeft {
    from { transform: translateX(-20px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  .brand {
    padding: 28px 24px 20px;
    border-bottom: 1px solid var(--border);
  }

  .brand-logo {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 4px;
  }

  .logo-icon {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    box-shadow: 0 0 20px var(--accent-glow);
  }

  .brand h1 {
    font-family: 'DM Serif Display', serif;
    font-size: 20px;
    letter-spacing: -0.3px;
    color: var(--text);
  }

  .brand h1 span {
    color: var(--accent);
  }

  .brand p {
    font-size: 11px;
    color: var(--text-muted);
    letter-spacing: 0.5px;
    text-transform: uppercase;
    margin-left: 46px;
  }

  .new-chat-btn {
    margin: 16px;
    padding: 11px 16px;
    background: linear-gradient(135deg, rgba(0,201,167,0.15), rgba(0,148,212,0.1));
    border: 1px solid rgba(0,201,167,0.3);
    border-radius: 10px;
    color: var(--accent);
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
    letter-spacing: 0.2px;
  }

  .new-chat-btn:hover {
    background: linear-gradient(135deg, rgba(0,201,167,0.25), rgba(0,148,212,0.2));
    box-shadow: 0 0 20px var(--accent-glow);
  }

  .sidebar-section {
    padding: 8px 16px 4px;
    font-size: 10px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
  }

  .history-list {
    flex: 1;
    overflow-y: auto;
    padding: 0 8px;
  }

  .history-list::-webkit-scrollbar { width: 4px; }
  .history-list::-webkit-scrollbar-track { background: transparent; }
  .history-list::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

  .history-item {
    padding: 10px 12px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.15s;
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 2px;
  }

  .history-item:hover { background: var(--surface2); }
  .history-item.active { background: rgba(0,201,167,0.08); }

  .history-item-icon {
    font-size: 14px;
    opacity: 0.6;
  }

  .history-item-text {
    font-size: 12.5px;
    color: var(--text-muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
  }

  .history-item.active .history-item-text { color: var(--text); }

  /* Quick topics */
  .quick-topics {
    padding: 12px 16px;
    border-top: 1px solid var(--border);
  }

  .quick-topics-label {
    font-size: 10px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
    margin-bottom: 10px;
  }

  .topic-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }

  .topic-chip {
    padding: 5px 10px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 20px;
    font-size: 11px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s;
  }

  .topic-chip:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: var(--accent-glow);
  }

  /* Status bar */
  .sidebar-status {
    padding: 16px;
    border-top: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--accent);
    box-shadow: 0 0 8px var(--accent);
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  .status-text {
    font-size: 12px;
    color: var(--text-muted);
  }

  .disclaimer-badge {
    margin-left: auto;
    padding: 3px 8px;
    background: rgba(255,77,109,0.1);
    border: 1px solid rgba(255,77,109,0.3);
    border-radius: 20px;
    font-size: 9px;
    color: var(--red);
    font-weight: 600;
    letter-spacing: 0.5px;
  }

  /* ‚îÄ‚îÄ MAIN CHAT ‚îÄ‚îÄ */
  .main {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: fadeIn 0.6s ease 0.1s both;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Header */
  .chat-header {
    padding: 20px 32px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(17,23,32,0.8);
    backdrop-filter: blur(10px);
  }

  .chat-header-left h2 {
    font-family: 'DM Serif Display', serif;
    font-size: 17px;
    color: var(--text);
    letter-spacing: -0.2px;
  }

  .chat-header-left p {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 1px;
  }

  .header-actions {
    display: flex;
    gap: 8px;
  }

  .header-btn {
    width: 36px;
    height: 36px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.2s;
    color: var(--text-muted);
  }

  .header-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
  }

  /* Messages area */
  .messages-area {
    flex: 1;
    overflow-y: auto;
    padding: 32px;
    display: flex;
    flex-direction: column;
    gap: 24px;
    scroll-behavior: smooth;
  }

  .messages-area::-webkit-scrollbar { width: 5px; }
  .messages-area::-webkit-scrollbar-track { background: transparent; }
  .messages-area::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  /* Welcome state */
  .welcome {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex: 1;
    text-align: center;
    padding: 40px;
    animation: fadeIn 0.8s ease;
  }

  .welcome-orb {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    margin-bottom: 24px;
    box-shadow:
      0 0 40px rgba(0,201,167,0.3),
      0 0 80px rgba(0,201,167,0.1);
    animation: orbFloat 3s ease-in-out infinite;
  }

  @keyframes orbFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }

  .welcome h2 {
    font-family: 'DM Serif Display', serif;
    font-size: 32px;
    color: var(--text);
    letter-spacing: -0.5px;
    margin-bottom: 12px;
    line-height: 1.2;
  }

  .welcome h2 em {
    font-style: italic;
    color: var(--accent);
  }

  .welcome p {
    font-size: 14px;
    color: var(--text-muted);
    max-width: 400px;
    line-height: 1.7;
    margin-bottom: 32px;
  }

  .suggestion-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    width: 100%;
    max-width: 520px;
  }

  .suggestion-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.25s;
    text-align: left;
  }

  .suggestion-card:hover {
    border-color: var(--accent);
    background: rgba(0,201,167,0.05);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.3);
  }

  .suggestion-card-icon { font-size: 20px; margin-bottom: 8px; }
  .suggestion-card-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
    margin-bottom: 4px;
  }
  .suggestion-card-desc {
    font-size: 11.5px;
    color: var(--text-muted);
    line-height: 1.5;
  }

  /* Message bubbles */
  .message {
    display: flex;
    gap: 14px;
    max-width: 800px;
    animation: msgIn 0.3s ease;
  }

  @keyframes msgIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .message.user { align-self: flex-end; flex-direction: row-reverse; }

  .avatar {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    flex-shrink: 0;
    margin-top: 4px;
  }

  .avatar.bot {
    background: linear-gradient(135deg, rgba(0,201,167,0.2), rgba(0,148,212,0.2));
    border: 1px solid rgba(0,201,167,0.3);
  }

  .avatar.user {
    background: rgba(255,255,255,0.06);
    border: 1px solid var(--border);
  }

  .bubble-wrap { display: flex; flex-direction: column; gap: 6px; }

  .bubble-meta {
    font-size: 10.5px;
    color: var(--text-dim);
    padding: 0 4px;
    letter-spacing: 0.3px;
  }

  .message.user .bubble-meta { text-align: right; }

  .bubble {
    padding: 14px 18px;
    border-radius: 14px;
    font-size: 14px;
    line-height: 1.7;
    color: var(--text);
    max-width: 560px;
    position: relative;
  }

  .bubble.bot {
    background: var(--bot-bubble);
    border: 1px solid var(--border);
    border-top-left-radius: 4px;
  }

  .bubble.user {
    background: var(--user-bubble);
    border: 1px solid rgba(0,148,212,0.25);
    border-top-right-radius: 4px;
  }

  /* Info card inside bot bubble */
  .info-card {
    margin-top: 12px;
    padding: 12px 14px;
    background: rgba(0,201,167,0.05);
    border: 1px solid rgba(0,201,167,0.2);
    border-radius: 8px;
    font-size: 13px;
    color: var(--text-muted);
  }

  .info-card-title {
    font-weight: 600;
    color: var(--accent);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    margin-bottom: 6px;
  }

  /* Disclaimer inside bubble */
  .disclaimer-inline {
    margin-top: 10px;
    padding: 8px 12px;
    background: rgba(255,209,102,0.05);
    border-left: 2px solid var(--yellow);
    font-size: 11.5px;
    color: var(--text-muted);
    border-radius: 0 6px 6px 0;
  }

  /* Typing indicator */
  .typing-indicator {
    display: flex;
    gap: 14px;
    max-width: 800px;
    animation: msgIn 0.3s ease;
  }

  .typing-dots {
    padding: 16px 20px;
    background: var(--bot-bubble);
    border: 1px solid var(--border);
    border-radius: 14px;
    border-top-left-radius: 4px;
    display: flex;
    gap: 5px;
    align-items: center;
  }

  .dot {
    width: 7px;
    height: 7px;
    background: var(--text-dim);
    border-radius: 50%;
    animation: dotBounce 1.2s infinite;
  }

  .dot:nth-child(2) { animation-delay: 0.2s; }
  .dot:nth-child(3) { animation-delay: 0.4s; }

  @keyframes dotBounce {
    0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
    30% { transform: translateY(-6px); opacity: 1; }
  }

  /* ‚îÄ‚îÄ INPUT AREA ‚îÄ‚îÄ */
  .input-area {
    padding: 20px 32px 24px;
    border-top: 1px solid var(--border);
    background: rgba(10,14,20,0.9);
    backdrop-filter: blur(10px);
  }

  .input-wrapper {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 4px 4px 4px 18px;
    display: flex;
    align-items: flex-end;
    gap: 10px;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .input-wrapper:focus-within {
    border-color: rgba(0,201,167,0.4);
    box-shadow: 0 0 0 3px rgba(0,201,167,0.06), 0 0 30px rgba(0,201,167,0.05);
  }

  .chat-input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    line-height: 1.6;
    resize: none;
    max-height: 140px;
    min-height: 44px;
    padding: 12px 0;
    overflow-y: auto;
  }

  .chat-input::placeholder { color: var(--text-dim); }

  .input-actions {
    display: flex;
    align-items: center;
    gap: 6px;
    padding-bottom: 4px;
  }

  .input-action-btn {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-muted);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    transition: all 0.2s;
  }

  .input-action-btn:hover {
    background: var(--surface2);
    color: var(--text);
    border-color: rgba(255,255,255,0.1);
  }

  .send-btn {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none;
    color: #0a0e14;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 17px;
    transition: all 0.2s;
    box-shadow: 0 4px 14px rgba(0,201,167,0.3);
    font-weight: 700;
  }

  .send-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(0,201,167,0.4);
  }

  .send-btn:active { transform: scale(0.97); }

  .input-footer {
    display: flex;
    justify-content: center;
    margin-top: 10px;
    font-size: 11px;
    color: var(--text-dim);
    gap: 4px;
  }

  .input-footer a {
    color: var(--text-muted);
    text-decoration: none;
    transition: color 0.2s;
  }
  .input-footer a:hover { color: var(--accent); }

  /* Source tags */
  .sources {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 10px;
  }

  .source-tag {
    padding: 3px 10px;
    background: rgba(0,148,212,0.08);
    border: 1px solid rgba(0,148,212,0.2);
    border-radius: 20px;
    font-size: 11px;
    color: var(--accent2);
    cursor: pointer;
    transition: all 0.2s;
  }

  .source-tag:hover {
    background: rgba(0,148,212,0.15);
  }

  /* Severity badge */
  .severity {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    margin-top: 8px;
  }

  .severity.low { background: rgba(0,201,167,0.1); color: var(--accent); border: 1px solid rgba(0,201,167,0.3); }
  .severity.med { background: rgba(255,209,102,0.1); color: var(--yellow); border: 1px solid rgba(255,209,102,0.3); }
  .severity.high { background: rgba(255,77,109,0.1); color: var(--red); border: 1px solid rgba(255,77,109,0.3); }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
</style>
</head>
<body>

<div class="layout">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-logo">
        <div class="logo-icon">‚öïÔ∏è</div>
        <h1>Medi<span>Bot</span></h1>
      </div>
      <p>AI Medical Assistant</p>
    </div>

    <button class="new-chat-btn" onclick="startNewChat()">
      <span>‚ú¶</span> New Consultation
    </button>

    <div class="sidebar-section">Recent</div>
    <div class="history-list" id="historyList">
      <div class="history-item active">
        <span class="history-item-icon">üíä</span>
        <span class="history-item-text">Headache and fever symptoms</span>
      </div>
      <div class="history-item">
        <span class="history-item-icon">ü©∫</span>
        <span class="history-item-text">Blood pressure interpretation</span>
      </div>
      <div class="history-item">
        <span class="history-item-icon">ü´Ä</span>
        <span class="history-item-text">Chest pain ‚Äî when to worry?</span>
      </div>
      <div class="history-item">
        <span class="history-item-icon">üß¨</span>
        <span class="history-item-text">Understanding cholesterol levels</span>
      </div>
      <div class="history-item">
        <span class="history-item-icon">üíâ</span>
        <span class="history-item-text">Vaccine schedule for adults</span>
      </div>
      <div class="history-item">
        <span class="history-item-icon">üçÉ</span>
        <span class="history-item-text">Natural anxiety remedies</span>
      </div>
    </div>

    <div class="quick-topics">
      <div class="quick-topics-label">Quick Topics</div>
      <div class="topic-chips">
        <span class="topic-chip" onclick="insertPrompt('What are common cold symptoms?')">Cold</span>
        <span class="topic-chip" onclick="insertPrompt('How to manage diabetes?')">Diabetes</span>
        <span class="topic-chip" onclick="insertPrompt('Back pain remedies')">Back Pain</span>
        <span class="topic-chip" onclick="insertPrompt('Sleep hygiene tips')">Sleep</span>
        <span class="topic-chip" onclick="insertPrompt('Mental health resources')">Mental Health</span>
        <span class="topic-chip" onclick="insertPrompt('Nutrition and diet advice')">Nutrition</span>
      </div>
    </div>

    <div class="sidebar-status">
      <div class="status-dot"></div>
      <span class="status-text">AI Model Active</span>
      <span class="disclaimer-badge">Not a Doctor</span>
    </div>
  </aside>

  <!-- MAIN CHAT -->
  <main class="main">
    <header class="chat-header">
      <div class="chat-header-left">
        <h2>Medical Consultation</h2>
        <p>Powered by your RAG medical knowledge base</p>
      </div>
      <div class="header-actions">
        <div class="header-btn" title="Download chat">‚¨á</div>
        <div class="header-btn" title="Clear chat" onclick="startNewChat()">üóë</div>
        <div class="header-btn" title="Settings">‚öô</div>
      </div>
    </header>

    <div class="messages-area" id="messagesArea">
      <!-- Welcome state (hidden when chat starts) -->
      <div class="welcome" id="welcomeState">
        <div class="welcome-orb">‚öïÔ∏è</div>
        <h2>Hello, I'm <em>MediBot</em></h2>
        <p>Your AI-powered medical assistant. Ask me about symptoms, medications, health conditions, or general wellness. I'll provide information from trusted medical sources.</p>
        <div class="suggestion-grid">
          <div class="suggestion-card" onclick="sendSuggestion('What are the symptoms of type 2 diabetes?')">
            <div class="suggestion-card-icon">ü©∏</div>
            <div class="suggestion-card-title">Diabetes Symptoms</div>
            <div class="suggestion-card-desc">Learn warning signs of type 2 diabetes</div>
          </div>
          <div class="suggestion-card" onclick="sendSuggestion('How can I lower my blood pressure naturally?')">
            <div class="suggestion-card-icon">‚ù§Ô∏è</div>
            <div class="suggestion-card-title">Blood Pressure</div>
            <div class="suggestion-card-desc">Natural ways to manage hypertension</div>
          </div>
          <div class="suggestion-card" onclick="sendSuggestion('What should I do if I have a persistent headache?')">
            <div class="suggestion-card-icon">üß†</div>
            <div class="suggestion-card-title">Persistent Headache</div>
            <div class="suggestion-card-desc">When headaches need medical attention</div>
          </div>
          <div class="suggestion-card" onclick="sendSuggestion('What vitamins should I take daily?')">
            <div class="suggestion-card-icon">üíä</div>
            <div class="suggestion-card-title">Daily Vitamins</div>
            <div class="suggestion-card-desc">Essential supplements for good health</div>
          </div>
        </div>
      </div>
    </div>

    <div class="input-area">
      <div class="input-wrapper">
        <textarea
          class="chat-input"
          id="chatInput"
          placeholder="Describe your symptoms or ask a medical question‚Ä¶"
          rows="1"
          onkeydown="handleKey(event)"
          oninput="autoResize(this)"
        ></textarea>
        <div class="input-actions">
          <button class="input-action-btn" title="Attach file">üìé</button>
          <button class="send-btn" onclick="sendMessage()" title="Send">‚û§</button>
        </div>
      </div>
      <div class="input-footer">
        ‚ö†Ô∏è For emergencies call <strong>&nbsp;911&nbsp;</strong>¬∑ MediBot provides information, not medical advice.&nbsp;
        <a href="#">Learn more</a>
      </div>
    </div>
  </main>
</div>

<script>
  // Demo responses for suggestions
  const demoResponses = {
    'What are the symptoms of type 2 diabetes?': {
      text: "Type 2 diabetes often develops gradually, and some people may not notice symptoms right away. Common signs to watch for include:",
      card: {
        title: "Key Symptoms",
        content: "Increased thirst & frequent urination ¬∑ Unexplained fatigue ¬∑ Blurred vision ¬∑ Slow-healing sores ¬∑ Frequent infections ¬∑ Tingling in hands or feet"
      },
      severity: "med",
      severityText: "Consult a doctor if you have 2+ symptoms",
      sources: ["Mayo Clinic", "CDC Diabetes", "WebMD"],
      disclaimer: "A proper diagnosis requires a fasting blood glucose test or HbA1c test by a healthcare professional."
    },
    'How can I lower my blood pressure naturally?': {
      text: "There are several evidence-based lifestyle changes that can significantly reduce blood pressure without medication:",
      card: {
        title: "Recommended Approaches",
        content: "DASH diet (less sodium, more potassium) ¬∑ Regular aerobic exercise 30 min/day ¬∑ Limit alcohol ¬∑ Quit smoking ¬∑ Reduce stress with meditation or yoga ¬∑ Maintain healthy weight"
      },
      severity: "low",
      severityText: "Lifestyle changes are generally safe",
      sources: ["AHA Guidelines", "NIH", "Lancet 2021"],
      disclaimer: "If your blood pressure is consistently above 140/90, please consult a physician ‚Äî you may need medication alongside lifestyle changes."
    },
    'What should I do if I have a persistent headache?': {
      text: "Persistent headaches lasting more than a few days warrant attention. Here's how to assess and act:",
      card: {
        title: "Action Steps",
        content: "Track frequency, location & triggers ¬∑ Stay hydrated ¬∑ Try OTC pain relief (ibuprofen/acetaminophen) ¬∑ Rest in a dark, quiet room ¬∑ Apply cold/warm compress"
      },
      severity: "high",
      severityText: "Seek emergency care for sudden severe headache",
      sources: ["Cleveland Clinic", "NHS UK", "AAN"],
      disclaimer: "Red flags requiring immediate care: sudden 'thunderclap' headache, headache with fever/stiff neck, vision changes, or weakness."
    },
    'What vitamins should I take daily?': {
      text: "For most adults, a few key vitamins are commonly deficient. Here's what evidence suggests:",
      card: {
        title: "Core Daily Supplements",
        content: "Vitamin D3 (1000‚Äì2000 IU) ¬∑ Vitamin B12 (especially if plant-based diet) ¬∑ Magnesium glycinate ¬∑ Omega-3 fatty acids ¬∑ Folate (especially for women of childbearing age)"
      },
      severity: "low",
      severityText: "Generally safe at recommended doses",
      sources: ["NIH ODS", "Harvard Health", "BMJ 2022"],
      disclaimer: "Individual needs vary. A blood panel can identify your specific deficiencies. Always inform your doctor of any supplements you take."
    }
  };

  let chatStarted = false;

  function autoResize(el) {
    el.style.height = 'auto';
    el.style.height = Math.min(el.scrollHeight, 140) + 'px';
  }

  function handleKey(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  }

  function insertPrompt(text) {
    document.getElementById('chatInput').value = text;
    document.getElementById('chatInput').focus();
  }

  function sendSuggestion(text) {
    document.getElementById('chatInput').value = text;
    sendMessage();
  }

  function startNewChat() {
    const area = document.getElementById('messagesArea');
    area.innerHTML = `
      <div class="welcome" id="welcomeState">
        <div class="welcome-orb">‚öïÔ∏è</div>
        <h2>Hello, I'm <em>MediBot</em></h2>
        <p>Your AI-powered medical assistant. Ask me about symptoms, medications, health conditions, or general wellness.</p>
        <div class="suggestion-grid">
          <div class="suggestion-card" onclick="sendSuggestion('What are the symptoms of type 2 diabetes?')">
            <div class="suggestion-card-icon">ü©∏</div>
            <div class="suggestion-card-title">Diabetes Symptoms</div>
            <div class="suggestion-card-desc">Learn warning signs of type 2 diabetes</div>
          </div>
          <div class="suggestion-card" onclick="sendSuggestion('How can I lower my blood pressure naturally?')">
            <div class="suggestion-card-icon">‚ù§Ô∏è</div>
            <div class="suggestion-card-title">Blood Pressure</div>
            <div class="suggestion-card-desc">Natural ways to manage hypertension</div>
          </div>
          <div class="suggestion-card" onclick="sendSuggestion('What should I do if I have a persistent headache?')">
            <div class="suggestion-card-icon">üß†</div>
            <div class="suggestion-card-title">Persistent Headache</div>
            <div class="suggestion-card-desc">When headaches need medical attention</div>
          </div>
          <div class="suggestion-card" onclick="sendSuggestion('What vitamins should I take daily?')">
            <div class="suggestion-card-icon">üíä</div>
            <div class="suggestion-card-title">Daily Vitamins</div>
            <div class="suggestion-card-desc">Essential supplements for good health</div>
          </div>
        </div>
      </div>`;
    chatStarted = false;
    document.getElementById('chatInput').value = '';
  }

  function sendMessage() {
    const input = document.getElementById('chatInput');
    const text = input.value.trim();
    if (!text) return;

    if (!chatStarted) {
      document.getElementById('welcomeState')?.remove();
      chatStarted = true;
    }

    addUserMessage(text);
    input.value = '';
    input.style.height = 'auto';

    const typingEl = addTypingIndicator();

    // Simulate response delay
    const delay = 1200 + Math.random() * 800;
    setTimeout(() => {
      typingEl.remove();
      const response = demoResponses[text] || generateGenericResponse(text);
      addBotMessage(response);
    }, delay);
  }

  function generateGenericResponse(text) {
    return {
      text: `Thank you for your question about "${text}". Based on the medical knowledge base, I can share some general information. Please remember that specific symptoms or conditions always require evaluation by a licensed healthcare provider.`,
      card: {
        title: "General Guidance",
        content: "Monitor your symptoms carefully ¬∑ Stay hydrated and rest ¬∑ Avoid self-medicating without guidance ¬∑ Consult a healthcare provider for personalized advice"
      },
      severity: "low",
      severityText: "General information only",
      sources: ["Medical Knowledge Base", "WHO Guidelines"],
      disclaimer: "This information is for educational purposes only and does not constitute medical advice."
    };
  }

  function addUserMessage(text) {
    const area = document.getElementById('messagesArea');
    const now = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    const el = document.createElement('div');
    el.className = 'message user';
    el.innerHTML = `
      <div class="avatar user">üë§</div>
      <div class="bubble-wrap">
        <div class="bubble-meta">You ¬∑ ${now}</div>
        <div class="bubble user">${escHtml(text)}</div>
      </div>`;
    area.appendChild(el);
    area.scrollTop = area.scrollHeight;
  }

  function addTypingIndicator() {
    const area = document.getElementById('messagesArea');
    const el = document.createElement('div');
    el.className = 'typing-indicator';
    el.innerHTML = `
      <div class="avatar bot">‚öïÔ∏è</div>
      <div class="typing-dots">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>`;
    area.appendChild(el);
    area.scrollTop = area.scrollHeight;
    return el;
  }

  function addBotMessage(response) {
    const area = document.getElementById('messagesArea');
    const now = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

    const sourceTags = response.sources.map(s =>
      `<span class="source-tag">üìÑ ${s}</span>`
    ).join('');

    const severityClass = response.severity === 'high' ? 'high' : response.severity === 'med' ? 'med' : 'low';

    const el = document.createElement('div');
    el.className = 'message';
    el.innerHTML = `
      <div class="avatar bot">‚öïÔ∏è</div>
      <div class="bubble-wrap">
        <div class="bubble-meta">MediBot ¬∑ ${now}</div>
        <div class="bubble bot">
          <p>${response.text}</p>
          <div class="info-card">
            <div class="info-card-title">${response.card.title}</div>
            ${response.card.content}
          </div>
          <div class="severity ${severityClass}">
            ${response.severity === 'high' ? 'üî¥' : response.severity === 'med' ? 'üü°' : 'üü¢'}
            ${response.severityText}
          </div>
          <div class="sources">${sourceTags}</div>
          <div class="disclaimer-inline">‚ö†Ô∏è ${response.disclaimer}</div>
        </div>
      </div>`;
    area.appendChild(el);
    area.scrollTop = area.scrollHeight;
  }

  function escHtml(text) {
    return text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  }
</script>
</body>
</html>
